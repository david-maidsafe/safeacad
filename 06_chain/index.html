



<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      <meta http-equiv="x-ua-compatible" content="ie=edge">
      
      
      
      
        <meta name="lang:clipboard.copy" content="Copy to clipboard">
      
        <meta name="lang:clipboard.copied" content="Copied to clipboard">
      
        <meta name="lang:search.language" content="en">
      
        <meta name="lang:search.pipeline.stopwords" content="True">
      
        <meta name="lang:search.pipeline.trimmer" content="True">
      
        <meta name="lang:search.result.none" content="No matching documents">
      
        <meta name="lang:search.result.one" content="1 matching document">
      
        <meta name="lang:search.result.other" content="# matching documents">
      
        <meta name="lang:search.tokenizer" content="[\s\-]+">
      
      <link rel="shortcut icon" href="../assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.0.4, mkdocs-material-4.0.2">
    
    
      
        <title>Chain - SAFE Fleming Bible</title>
      
    
    
      <link rel="stylesheet" href="../assets/stylesheets/application.982221ab.css">
      
        <link rel="stylesheet" href="../assets/stylesheets/application-palette.224b79ff.css">
      
      
        
        
        <meta name="theme-color" content="#ff7043">
      
    
    
      <script src="../assets/javascripts/modernizr.1f0bcf2b.js"></script>
    
    
      
        <link href="https://fonts.gstatic.com" rel="preconnect" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,400,400i,700|Roboto+Mono">
        <style>body,input{font-family:"Roboto","Helvetica Neue",Helvetica,Arial,sans-serif}code,kbd,pre{font-family:"Roboto Mono","Courier New",Courier,monospace}</style>
      
    
    <link rel="stylesheet" href="../assets/fonts/material-icons.css">
    
    
    
      
    
    
  </head>
  
    
    
    <body dir="ltr" data-md-color-primary="deep-orange" data-md-color-accent="indigo">
  
    <svg class="md-svg">
      <defs>
        
        
      </defs>
    </svg>
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" data-md-component="overlay" for="__drawer"></label>
    
      <a href="#chain" tabindex="1" class="md-skip">
        Skip to content
      </a>
    
    
      <header class="md-header" data-md-component="header">
  <nav class="md-header-nav md-grid">
    <div class="md-flex">
      <div class="md-flex__cell md-flex__cell--shrink">
        <a href=".." title="SAFE Fleming Bible" class="md-header-nav__button md-logo">
          
            <i class="md-icon"></i>
          
        </a>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        <label class="md-icon md-icon--menu md-header-nav__button" for="__drawer"></label>
      </div>
      <div class="md-flex__cell md-flex__cell--stretch">
        <div class="md-flex__ellipsis md-header-nav__title" data-md-component="title">
          
            <span class="md-header-nav__topic">
              SAFE Fleming Bible
            </span>
            <span class="md-header-nav__topic">
              Chain
            </span>
          
        </div>
      </div>
      <div class="md-flex__cell md-flex__cell--shrink">
        
          <label class="md-icon md-icon--search md-header-nav__button" for="__search"></label>
          
<div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="query" data-md-state="active">
      <label class="md-icon md-search__icon" for="__search"></label>
      <button type="reset" class="md-icon md-search__icon" data-md-component="reset" tabindex="-1">
        &#xE5CD;
      </button>
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" data-md-scrollfix>
        <div class="md-search-result" data-md-component="result">
          <div class="md-search-result__meta">
            Type to start searching
          </div>
          <ol class="md-search-result__list"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
        
      </div>
      
    </div>
  </nav>
</header>
    
    <div class="md-container">
      
        
      
      
      <main class="md-main">
        <div class="md-main__inner md-grid" data-md-component="container">
          
            
              <div class="md-sidebar md-sidebar--primary" data-md-component="navigation">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    <nav class="md-nav md-nav--primary" data-md-level="0">
  <label class="md-nav__title md-nav__title--site" for="__drawer">
    <a href=".." title="SAFE Fleming Bible" class="md-nav__button md-logo">
      
        <i class="md-icon"></i>
      
    </a>
    SAFE Fleming Bible
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
      


  <li class="md-nav__item">
    <a href=".." title="SAFE Fleming Bible" class="md-nav__link">
      SAFE Fleming Bible
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../01_glossary/" title="Glossary" class="md-nav__link">
      Glossary
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../02_sharding/" title="Sharding / Disjoint Sections" class="md-nav__link">
      Sharding / Disjoint Sections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../03_authorities/" title="Authorities" class="md-nav__link">
      Authorities
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../04_sections/" title="Groups & Sections" class="md-nav__link">
      Groups & Sections
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../05_messaging/" title="Message Relay & SMR" class="md-nav__link">
      Message Relay & SMR
    </a>
  </li>

    
      
      
      

  


  <li class="md-nav__item md-nav__item--active">
    
    <input class="md-toggle md-nav__toggle" data-md-toggle="toc" type="checkbox" id="__toc">
    
      
    
    
      <label class="md-nav__link md-nav__link--active" for="__toc">
        Chain
      </label>
    
    <a href="./" title="Chain" class="md-nav__link md-nav__link--active">
      Chain
    </a>
    
      
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" title="Status" class="md-nav__link">
    Status
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" title="How it works" class="md-nav__link">
    How it works
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worked-example" title="Worked example" class="md-nav__link">
    Worked example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" title="Features" class="md-nav__link">
    Features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benefits" title="Benefits" class="md-nav__link">
    Benefits
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
    
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../07_parsec/" title="PARSEC" class="md-nav__link">
      PARSEC
    </a>
  </li>

    
      
      
      


  <li class="md-nav__item">
    <a href="../08_ageing/" title="Node Ageing" class="md-nav__link">
      Node Ageing
    </a>
  </li>

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              <div class="md-sidebar md-sidebar--secondary" data-md-component="toc">
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    
<nav class="md-nav md-nav--secondary">
  
  
    
  
  
    <label class="md-nav__title" for="__toc">Table of contents</label>
    <ul class="md-nav__list" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#summary" title="Summary" class="md-nav__link">
    Summary
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#status" title="Status" class="md-nav__link">
    Status
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#how-it-works" title="How it works" class="md-nav__link">
    How it works
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#worked-example" title="Worked example" class="md-nav__link">
    Worked example
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#features" title="Features" class="md-nav__link">
    Features
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#benefits" title="Benefits" class="md-nav__link">
    Benefits
  </a>
  
</li>
      
      
      
      
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          <div class="md-content">
            <article class="md-content__inner md-typeset">
              
                
                
                <h1 id="chain">Chain</h1>
<h2 id="summary">Summary</h2>
<p>The chain is a record of action, decisions and activity of sections and their neighbours. It stores Section Info, Proofs, and Neighbour Info for the purposes of relaying it to other sections.</p>
<p>The chain is not linear but instead should be visualised as a <strong>chain of trust</strong>.</p>
<h2 id="status">Status</h2>
<p>New</p>
<h2 id="how-it-works">How it works</h2>
<p>The chain is a record of action, decisions and activity of sections in order to give clarity to others who do not see the gossip graph, membership list or events. In the case of PARSEC interesting blocks and consensus blocks are recorded on the chain.</p>
<p>The chain exists to relay section info which has been verified (by a quorum of signatures) to other sections.  </p>
<p>The chain is not linear but instead should be visualised as a <strong>chain of trust</strong>. Each section has a linear sequence but they also see their neighbour's linear sequence thus creating the web.</p>
<p><img alt="chain of trust" src="../images/0601_chain.png" /></p>
<p>Chains are written to the memory of the node and reside there for the lifetime of the session.</p>
<p>Things that are kept on the chain</p>
<ul>
<li>Proofs (signatures of quorum members of the section)</li>
<li>Neighbour info</li>
<li>Section info is an object that contains info of the section that is signed by a quorum of members, section info includes:<ul>
<li>Section Prefix - the first numbers at the beginning on the XOR address that define the nodes section</li>
<li>Version - a number which increases incrementally as members change</li>
<li>Members - public identity (public key and encryption key)</li>
<li>Previous hash - previous section info</li>
<li>Hash (all of the above)</li>
</ul>
</li>
</ul>
<p><strong>Previous hash</strong> is a list, comparable to a blockchain that points to previous section info, for example. there will be 2 hashes of 2 previous section info when a merge has been completed.</p>
<p><strong>Membership:</strong> Always changes by one except in the case of merges when all nodes from the merging section are added at once.</p>
<p><strong>Versions:</strong> The members of a section at a given point in time. Members can only change (add/leave) one at a time, and the version increases by one with each change.  Changes are singular. Except in the case of merges where there may be a version shift in one child.  The child with the smaller version will experience a version shift (by more than one), while the version number of the other child increase incrementally by one. Each version will be signed by a quorum of members to be considered valid by another section.</p>
<p>A version shift change can be seen as a bug.  Unless accompanied by the following as these would highlight a merge.
- A prefix change
- A membership list change shift</p>
<p>In the case of a split, children will hold the previous section info from the parent in the previous hash.</p>
<p>The chain captures <strong>OurInfo</strong> as well as <strong>NeighbourInfo</strong>. The advantage of recording this sequence is that a peer cannot lie and/or alter the sequence or entries as the hashes are sequential and incremental.</p>
<p><strong>OurInfo:</strong> maintained by self and holds every piece of historic section info
<strong>NeighbourInfo:</strong> maintain info about neighbours, however, only the latest state is maintained. This is replaced after each churn event.  In order to update neighbour info the section must receive signatures from a quorum of known members.</p>
<p>The chain would also hold signatures to verify each section info from a quorum of section members.</p>
<h2 id="worked-example">Worked example</h2>
<p>The following example incorporates these concepts:</p>
<pre><code>**Network Genesis - Min section size 3, Buffer 0**


Si: {Members: (0,1), Prefix: ( ), Version (0), PreviousHash ( )}

Si: {Members: (0,1,2), Prefix: ( ), Version (1), PreviousHash (Si 0)}, proofs Si 0

Si: {Members: (0,1,2,3), Prefix: ( ), Version (2), PreviousHash (Si 1)}, proofs Si 1

Si: {Members: (0,1,2,3,4), Prefix: ( ), Version (3), PreviousHash (Si 2)}, Proofs Si 2

New node(5) joins triggering a split

Section splits

Si: {Members: (0,1,2,3)            Si:{Members: (4,5,6)
Prefix: (0)                        Prefix: (1)
Version (4)                        Version (4)
PreviousHash (Si 3)}               PreviousHash (Si 3)}
Proofs Si 3                        Proofs Si 3                         

No change                          +1 (node 8 joins)


Si: {Members: (0,1,2,3)            Si: {Members:(4,5,6,8)
Prefix: (0)                        Prefix: (1)
Version (4)                        Version (5)
PreviousHash (Si 3)}               PreviousHash (Si 4)}   
Proofs Si 3                        Proofs Si 4

- 1 (node 2 leaves)                - 1 (node 6 leaves)


Si: {Members: (0,1,3)              Si:{Members: (4,5,8)
Prefix: (0)                        Prefix: (1)
Version (5)                        Version (6)
PreviousHash (Si 4)}               PreviousHash (Si 5)}  
Proofs Si 4                        Proofs Si 5    

No change                          - 1 (node 5 leaves)


Si: {Members: (0,1,3)              Si: {Members: (4,8)
Prefix: (0)                        Prefix: (1)
Version (5)                        Version (7)
PreviousHash (Si 4)}               PreviousHash (Si 6)}    
Proofs Si 4                        Proofs Si 6

Section (Prefix 1) falls below min section size - merge triggered


Si: {Members: (0,1,3,4,8)
Prefix:( )
Version (8)
PreviousHash (Si 5, Si 7)
Proofs Si 5, Si 7

</code></pre>

<h2 id="features">Features</h2>
<ul>
<li>Linear and non-linear chain (chain of trust)</li>
<li>Hash entries are only sequential and incremental</li>
</ul>
<h2 id="benefits">Benefits</h2>
<ul>
<li>Enables a record of action, decisions and activity of sections to be passed between neighbouring sections.</li>
</ul>
                
                  
                
              
              
                


              
            </article>
          </div>
        </div>
      </main>
      
        
<footer class="md-footer">
  
    <div class="md-footer-nav">
      <nav class="md-footer-nav__inner md-grid">
        
          <a href="../05_messaging/" title="Message Relay & SMR" class="md-flex md-footer-nav__link md-footer-nav__link--prev" rel="prev">
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-back md-footer-nav__button"></i>
            </div>
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Previous
                </span>
                Message Relay & SMR
              </span>
            </div>
          </a>
        
        
          <a href="../07_parsec/" title="PARSEC" class="md-flex md-footer-nav__link md-footer-nav__link--next" rel="next">
            <div class="md-flex__cell md-flex__cell--stretch md-footer-nav__title">
              <span class="md-flex__ellipsis">
                <span class="md-footer-nav__direction">
                  Next
                </span>
                PARSEC
              </span>
            </div>
            <div class="md-flex__cell md-flex__cell--shrink">
              <i class="md-icon md-icon--arrow-forward md-footer-nav__button"></i>
            </div>
          </a>
        
      </nav>
    </div>
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-footer-copyright">
        
        powered by
        <a href="https://www.mkdocs.org">MkDocs</a>
        and
        <a href="https://squidfunk.github.io/mkdocs-material/">
          Material for MkDocs</a>
      </div>
      
    </div>
  </div>
</footer>
      
    </div>
    
      <script src="../assets/javascripts/application.d9aa80ab.js"></script>
      
      <script>app.initialize({version:"1.0.4",url:{base:".."}})</script>
      
    
  </body>
</html>